{
   "CVE_data_meta" : {
      "ASSIGNER" : "security@xenproject.org",
      "ID" : "CVE-2021-28687"
   },
   "affects" : {
      "vendor" : {
         "vendor_data" : [
            {
               "product" : {
                  "product_data" : [
                     {
                        "product_name" : "xen",
                        "version" : {
                           "version_data" : [
                              {
                                 "version_value" : "xen-unstable"
                              }
                           ]
                        }
                     },
                     {
                        "product_name" : "xen",
                        "version" : {
                           "version_data" : [
                              {
                                 "version_affected" : "?<",
                                 "version_value" : "4.12"
                              },
                              {
                                 "version_affected" : ">=",
                                 "version_value" : "4.12.x"
                              },
                              {
                                 "version_affected" : "!>",
                                 "version_value" : "4.13.x"
                              }
                           ]
                        }
                     },
                     {
                        "product_name" : "xen",
                        "version" : {
                           "version_data" : [
                              {
                                 "version_value" : "4.14.x"
                              }
                           ]
                        }
                     }
                  ]
               },
               "vendor_name" : "Xen"
            }
         ]
      }
   },
   "configuration" : {
      "configuration_data" : {
         "description" : {
            "description_data" : [
               {
                  "lang" : "eng",
                  "value" : "Only Xen versions 4.12 through 4.14 are affected.  Earlier versions\nare not affected.\n\nThe issue affects only systems with a guest monitoring process, which\nis linked against libxl, and which is important other than simply for\nthe functioning of one particular guest.  libvirt is one common\ntoolstack affected.  Systems using the `xl` command-line tool should\ngenerally suffer no security-relevant effects.\n\nThe xapi toolstack does not currently link against libxl, and so is\nnot affected."
               }
            ]
         }
      }
   },
   "credit" : {
      "credit_data" : {
         "description" : {
            "description_data" : [
               {
                  "lang" : "eng",
                  "value" : "This issue was discovered by Olaf Hering."
               }
            ]
         }
      }
   },
   "data_format" : "MITRE",
   "data_type" : "CVE",
   "data_version" : "4.0",
   "description" : {
      "description_data" : [
         {
            "lang" : "eng",
            "value" : "HVM soft-reset crashes toolstack\n\nlibxl requires all data structures passed across its public interface\nto be initialized before use and disposed of afterwards by calling a\nspecific set of functions.  Many internal data structures also require\nthis initialize / dispose discipline, but not all of them.\n\nWhen the \"soft reset\" feature was implemented, the\nlibxl__domain_suspend_state structure didn't require any\ninitialization or disposal.  At some point later, an initialization\nfunction was introduced for the structure; but the \"soft reset\" path\nwasn't refactored to call the initialization function.  When a guest\nnwo initiates a \"soft reboot\", uninitialized data structure leads to\nan assert() when later code finds the structure in an unexpected\nstate.\n\nThe effect of this is to crash the process monitoring the guest.  How\nthis affects the system depends on the structure of the toolstack.\n\nFor xl, this will have no security-relevant effect: every VM has its\nown independent monitoring process, which contains no state.  The\ndomain in question will hang in a crashed state, but can be destroyed\nby `xl destroy` just like any other non-cooperating domain.\n\nFor daemon-based toolstacks linked against libxl, such as libvirt,\nthis will crash the toolstack, losing the state of any in-progress\noperations (localized DoS), and preventing further administrator\noperations unless the daemon is configured to restart automatically\n(system-wide DoS).  If crashes \"leak\" resources, then repeated crashes\ncould use up resources, also causing a system-wide DoS."
         }
      ]
   },
   "impact" : {
      "impact_data" : {
         "description" : {
            "description_data" : [
               {
                  "lang" : "eng",
                  "value" : "A malicious guest can crash the management daemon, leading to at least\na localized, possibly system-wide denial-of-service."
               }
            ]
         }
      }
   },
   "problemtype" : {
      "problemtype_data" : [
         {
            "description" : [
               {
                  "lang" : "eng",
                  "value" : "unknown"
               }
            ]
         }
      ]
   },
   "references" : {
      "reference_data" : [
         {
            "url" : "https://xenbits.xenproject.org/xsa/advisory-368.txt"
         }
      ]
   },
   "workaround" : {
      "workaround_data" : {
         "description" : {
            "description_data" : [
               {
                  "lang" : "eng",
                  "value" : "Ensuring that any management daemons are restarted automatically after\na crash will partially mitigate the issue."
               }
            ]
         }
      }
   }
}
